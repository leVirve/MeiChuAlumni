<!DOCTYPE html>
<html class="no-js">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="description" content="梅竹賽五倍祝福">
  <meta name="keywords" content="梅竹, 梅竹賽, 清大, 交大, 清交梅竹賽, 乙未梅竹">
  <meta name="author" content="Salas">
  <meta property="og:url" content="http://meichualumni.appspot.com/blessings" />
  <meta property="og:title" content="梅竹賽五倍祝福" />
  <meta property="og:type" content="website" />
  <meta property="og:description" content="乙未梅竹熱血開賽，一同為梅竹賽祈福！" />
  <meta property="og:image" content="http://i.imgur.com/uP7Z6zK.jpg" />
  <title>許梅竹一個未來</title>
  <link rel="shortcut icon" href="/static/img/favicon.ico">
  <link href="/static/css/materialize.min.css" rel="stylesheet">
  <link href="/static/css/messageline.css" rel="stylesheet">
  <link href="/static/css/demo.css" rel="stylesheet">
  <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
  <script src="/static/js/materialize.min.js"></script>
  <script src="/static/js/Chart.min.js"></script>
  <script src="/static/js/blessing.js"></script>
</head>
<body style="background:#ededed">
  {% include 'includes/nav.html' %}
  <div class="wrap" style="">
    <div class="t-content">
      <section id="home">
        {% include 'main_page.html' %}
      </section>
      <section id="content">
        <div class="row">
          {% include 'content.html' %}
        </div>
      </section>
      <section id="blessing">
        <div class="row">
          <div class="col offset-l2 s12 m8 l8">
          {% include 'form.html' %}
          {% include 'list_messages.html' %}
          </div>
          <div class="col hide-on-small-only m3 l2">
            <ul class="section table-of-contents">
              <li><a href="#new-message-form">發表祝福</a></li>
              <li><a href="#mflow">看看祈福串</a></li>
            </ul>
          </div>
        </div>
      </section>
      <section id="photo">
        <div class="center-align">
          <div class="" style="padding: 50px 0;">
            {% include 'includes/loader.html' %}
          </div>
        </div>
      </section>
    </div><!-- /content -->
  </div><!-- /tabs -->

  {% include 'includes/footer.html' %}


  {% block tail_script %}
  <script>
    $(function() {
      var raw = [
        {% for c in counts %}
        {
            value: {{ c[1] }},
            label: "{{ c[0] }}"
        },
        {% endfor %}
      ];
      processChart(raw);
      {% if more %}
      $('#more').click(function(ev) {
        if(!$(this).val()) return false;
        $.get("/blessings/more", {'cursor': $(this).val()},
          function(d) {
            d.messages.forEach(function(m) {
              var c = createNode(
                m.timestamp,
                m.description,
                m.grade,
                m.department);
              document.getElementById("mflow").appendChild(c);
              next = d.more ? d.next_src : '';
              $('#more').val(next);
            });
          }
        );
      });
      {% endif %}
      // Floating-Fixed table of contents
      if ($('.table-of-contents').length) {
        var toc_offset = $('.table-of-contents').first().offset().top;
        $('.table-of-contents').each(function() {
          var origin = $(this);
          origin.pushpin({ top: toc_offset + $('header')[0].offsetHeight,
            bottom: $(document).height() - window.innerHeight });
        });
      }
    });
  </script>
  {% endblock %}
  {{ profiler_includes|safe }}
</body>
</html>
